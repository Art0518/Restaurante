<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administrador – Menú</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="img/logo-rincon.png">
    <link rel="shortcut icon" type="image/png" href="img/logo-rincon.png">

 <link rel="stylesheet" href="css/style.css">

    <style>
        body {
        padding-top: 90px;
        }

  .contenedor {
   max-width: 1200px;
   margin: 30px auto;
    padding: 10px;
  }

  .tarjeta {
background: #fffaf2;
      border: 1px solid #e6d5b8;
        border-radius: 16px;
  padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.06);
        }

        .filtros-container {
  display: flex;
            gap: 15px;
      align-items: center;
          justify-content: space-between;
      margin-bottom: 15px;
        }

  .filtros-container input {
      flex: 1;
     padding: 10px 15px;
       border-radius: 10px;
     border: 1px solid #d4c4a8;
        background: #fffdf7;
            font-size: 14px;
            }

     .filtros-container input:focus {
           outline: none;
   border-color: #6b8e23;
        box-shadow: 0 0 0 3px rgba(107, 142, 35, 0.1);
        }

        .grid-platos {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

    .plato-card {
            background: white;
     border-radius: 12px;
            border: 1px solid #f0e6d2;
            overflow: hidden;
            transition: all 0.3s ease;
 }

            .plato-card:hover {
    transform: translateY(-5px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
}

        .plato-imagen {
            width: 100%;
            height: 180px;
    object-fit: cover;
         background: #f8f5f0;
        }

   .plato-content {
            padding: 15px;
        }

        .plato-nombre {
   font-size: 16px;
        font-weight: 700;
            color: #5a4a3a;
       margin: 0 0 5px 0;
   }

        .plato-descripcion {
          font-size: 13px;
      color: #7a7a7a;
 margin-bottom: 10px;
         display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
      overflow: hidden;
        }

     .plato-precio {
            font-size: 18px;
   font-weight: 700;
            color: #2e7d32;
            margin-bottom: 10px;
        }

        .plato-estado {
            font-size: 12px;
            padding: 4px 8px;
  border-radius: 12px;
     font-weight: 600;
            text-transform: uppercase;
        }

.estado-disponible {
   background: #c8e6c9;
  color: #2e7d32;
        }

        .estado-no-disponible {
      background: #ffcdd2;
  color: #d32f2f;
        }

        .plato-acciones {
  margin-top: 15px;
   display: flex;
     gap: 8px;
        }

        .btn-editar,
    .btn-eliminar,
        .btn-toggle-disponibilidad {
          padding: 8px 16px;
 border: none;
    border-radius: 8px;
     cursor: pointer;
            font-size: 12px;
        font-weight: 600;
            text-transform: uppercase;
       transition: all 0.2s;
        }

        .btn-editar {
    background: #1976d2;
        color: white;
 flex: 1;
        }

        .btn-editar:hover {
           background: #1565c0;
         }

        .btn-eliminar {
            background: #d32f2f;
            color: white;
        flex: 1;
        }

            .btn-eliminar:hover {
    background: #c62828;
            }

        .btn-toggle-disponibilidad {
            background: #ff9800;
            color: white;
    flex: 2;
        }

     .btn-toggle-disponibilidad:hover {
        background: #f57c00;
         }

  .btn-nuevo-plato {
       background: #4caf50;
       color: white;
          padding: 12px 25px;
            border: none;
 border-radius: 10px;
         font-weight: 600;
            cursor: pointer;
            margin-bottom: 20px;
            transition: background 0.3s;
 }

            .btn-nuevo-plato:hover {
   background: #388e3c;
     }

        /* MODAL */
     .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
     width: 100%;
            height: 100%;
        background: rgba(0, 0, 0, 0.5);
     z-index: 1000;
      }

        .modal-content {
            background: white;
            margin: 50px auto;
      padding: 20px;
     border-radius: 12px;
     width: 90%;
      max-width: 500px;
     position: relative;
  }

        .close {
       position: absolute;
top: 15px;
            right: 20px;
    font-size: 28px;
 cursor: pointer;
  color: #888;
}

    .close:hover {
        color: #000;
            }

        .form-group {
  margin-bottom: 15px;
        }

      .form-group label {
       display: block;
   margin-bottom: 5px;
      font-weight: 600;
    color: #5a4a3a;
            }

            .form-group input,
            .form-group textarea,
   .form-group select {
          width: 100%;
       padding: 10px;
              border: 1px solid #d4c4a8;
         border-radius: 8px;
                box-sizing: border-box;
}

    .form-group textarea {
                height: 80px;
        resize: vertical;
     }

        .btn-guardar {
  padding: 10px 20px;
            border: none;
  border-radius: 8px;
    cursor: pointer;
 background: #4caf50;
          color: white;
      }

   .sin-resultados {
    text-align: center;
            padding: 40px;
        color: #888;
  }

        /* Responsive */
        @media (max-width: 768px) {
      .filtros-container {
     grid-template-columns: 1fr;
  }

  .grid-platos {
 grid-template-columns: 1fr;
       }

        .modal-content {
  margin: 20px auto;
          padding: 15px;
         }
        }

        .alert {
position: fixed;
     top: 20px;
      right: 20px;
   padding: 15px 20px;
 border-radius: 8px;
    z-index: 1001;
     max-width: 400px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        font-weight: 600;
      }

            .alert.success {
        background: #d4edda;
      color: #155724;
     border: 1px solid #c3e6cb;
    }

      .alert.error {
                background: #f8d7da;
       color: #721c24;
border: 1px solid #f5c6cb;
     }

        .alert.info {
    background: #d1ecf1;
         color: #0c5460;
 border: 1px solid #bee5eb;
     }

        .loading {
 position: fixed;
  top: 50%;
      left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
     border-radius: 10px;
 z-index: 1002;
     display: none;
        }
    </style>
</head>

<body>
    <!-- Navbar -->
    <div id="navbar-container"></div>

    <script>
        fetch("components/navbar.html")
     .then(res => res.text())
          .then(html => {
        document.getElementById("navbar-container").innerHTML = html;

              // Cargar navbar.js después de insertar el navbar en el DOM
            const script = document.createElement("script");
             script.src = "js/navbar.js";
  document.body.appendChild(script);
      });
    </script>

    <!-- Auth Modal -->
    <div id="auth-modal-container"></div>
    <script>
        fetch("components/auth-modal.html")
     .then(res => res.text())
        .then(html => {
   document.getElementById("auth-modal-container").innerHTML = html;
      })
         .catch(error => {
        console.error("Error cargando el modal de autenticación:", error);
});
    </script>

    <div class="contenedor">
<div class="tarjeta">
 <h2 style="color: #5a4a3a; margin-bottom: 20px;">Administración del Menú</h2>

<!-- Filtros y búsqueda -->
            <div class="filtros-container">
          <input type="text" id="busquedaPlato" placeholder="Buscar plato...">
       <button class="btn-nuevo-plato" onclick="abrirModalNuevo()">+ Nuevo Plato</button>
  </div>

<!-- Grid de platos -->
      <div class="grid-platos" id="gridPlatos">
     <!-- Los platos se cargan aquí dinámicamente -->
     </div>

      <!-- Sin resultados -->
            <div class="sin-resultados" id="sinResultados" style="display: none;">
                <h3>No se encontraron platos</h3>
              <p>Intenta con otros filtros o agrega un nuevo plato.</p>
   </div>
        </div>
    </div>

    <!-- Modal para agregar/editar plato -->
    <div id="modalPlato" class="modal">
        <div class="modal-content">
          <span class="close" onclick="cerrarModal()">&times;</span>
  <h3 id="tituloModal">Nuevo Plato</h3>

            <form id="formPlato">
 <div class="form-group">
  <label for="nombrePlato">Nombre del Plato:</label>
         <input type="text" id="nombrePlato" required>
   <small style="color: #888; font-size: 12px;">Solo letras, espacios, ñ y tildes (á, é, í, ó, ú)</small>
          </div>

             <div class="form-group">
   <label for="descripcionPlato">Descripción:</label>
         <textarea id="descripcionPlato" required></textarea>
           <small style="color: #888; font-size: 12px;">Letras, números, ñ, tildes y puntuación básica (.,;:?!"-)</small>
  </div>

     <div class="form-group">
       <label for="precioPlato">Precio:</label>
        <input type="number" id="precioPlato" step="0.01" min="0.01" required>
       </div>

             <div class="form-group">
         <label for="categoriaPlato">Tipo:</label>
   <select id="categoriaPlato" required>
     <option value="">Seleccionar tipo</option>
        <option value="Entrada">Entrada</option>
         <option value="Plato Principal">Plato Principal</option>
      <option value="Postre">Postre</option>
   <option value="Bebida">Bebida</option>
   </select>
          </div>

          <div class="form-group">
          <label for="imagenPlatoFile">Subir Imagen (Cloudinary):</label>
     <input type="file" id="imagenPlatoFile" accept="image/*">
       </div>

      <div class="form-group">
       <img id="previewImagen" src="" alt="Preview" style="max-width: 100%; max-height: 200px; display: none; border-radius: 8px; margin-top: 10px;">
    </div>

    <div style="text-align: right;">
    <button type="submit" class="btn-guardar">Guardar</button>
         </div>
            </form>
      </div>
    </div>

    <!-- Modales de Notificación -->
    <div id="notification-modal-container"></div>
    <div id="confirmation-modal-container"></div>
    
    <script>
   // Cargar modales de notificación
 fetch("components/notification-modal.html")
            .then(res => res.text())
   .then(html => {
      document.getElementById("notification-modal-container").innerHTML = html;
 })
  .catch(error => console.error("Error cargando notification modal:", error));

        fetch("components/confirmation-modal.html")
      .then(res => res.text())
     .then(html => {
                document.getElementById("confirmation-modal-container").innerHTML = html;
 })
            .catch(error => console.error("Error cargando confirmation modal:", error));
    </script>

    <!-- Footer -->
    <div id="footer-container"></div>
    <script>
     fetch("components/footer.html")
       .then(res => res.text())
            .then(html => {
       document.getElementById("footer-container").innerHTML = html;
  })
       .catch(error => {
 console.error("Error cargando el footer:", error);
       });
  </script>

  <script src="js/notifications.js"></script>
    <script src="js/admin-menu.js"></script>
    <script src="js/auth.js"></script>
</body>

</html>
